{"version":3,"sources":["App.tsx","form/auth.tsx","Login.tsx","Error.tsx","module/RoutePrivate.tsx","redux/actionTypes.tsx","redux/reducers/auth.tsx","redux/reducers/index.js","redux/storeConfig.tsx","module/auth/tokenBearer.tsx","module/auth/ya/verification.tsx","index.tsx"],"names":["App","_","url","require","AuthForm","p","className","src","onClick","requestUrl","parse","format","protocol","hostname","pathname","query","response_type","client_id","ya","clientID","redirect_uri","callbackURL","window","open","href","alt","Login","apiSettings","React","useState","Error","PrivateRoute","children","appSettings","rest","render","to","basePath","AUTHORIZE","LOGOUT","authorized","initialState","payload","state","action","type","createRootReducer","history","combineReducers","router","connectRouter","auth","createBrowserHistory","tokenBearer","isAuthorised","access_token","refresh_token","token_type","expires_in","y_curi","y_cid","y_cs","getTokenByCode","code","a","form_data","FormData","append","axios","post","then","response","undefined","data","error","error_description","this","clientSecret","AuthVerification","preloadedState","appState","setAppState","info","useEffect","URLSearchParams","location","search","get","catch","console","log","store","createStore","compose","applyMiddleware","routerMiddleware","process","REACT_APP_BASE_PATH","tokenKey","REACT_APP_TOKEN_KEY","cookieKey","REACT_APP_COOKIE_KEY","publicKey","REACT_APP_PUBLIC_KEY","api","REACT_APP_API_PATH","domain","REACT_APP_CURRENT_DOMAIN","REACT_APP_YA_CID","REACT_APP_YA_CIS","REACT_APP_YA_CURI","ReactDOM","exact","path","StrictMode","RoutePrivate","component","document","getElementById"],"mappings":"8NAOeA,EAJH,SAACC,GACT,OAAO,6C,QCALC,G,MAAMC,EAAQ,KA0BLC,MAxBf,SAAmBC,GAiBf,OACI,sBAAMC,UAAU,QAAhB,SACI,qBAAKC,IAAI,mBAAmBC,QAjBnB,WACb,IAAMC,EAAaP,EAAIQ,MAAMR,EAAIS,OAAO,CACpCC,SAAU,QACVC,SAAU,kBACVC,SAAU,aACVC,MAAO,CACHC,cAAe,OACfC,UAAWZ,EAAEa,GAAGC,SAChBC,aAAcf,EAAEa,GAAGG,gBAI3BC,OAAOC,KAAKd,EAAWe,KAAM,UAKsBC,IAAI,yLCThDC,EAZD,SAACC,GACX,MAAqBC,IAAMC,UAAS,GAEpC,OAFA,oBAQO,4CAJK,cAAC,EAAD,eAAcF,K,MCGfG,MATf,WACI,OACI,gCACI,+CACA,mBAAGN,KAAM,IAAT,sC,oECKGO,MARf,YAA6I,EAArHC,SAAsH,IAA5GC,EAA2G,EAA3GA,YAAgBC,EAA2F,iBACzI,OACI,cAAC,IAAD,2BAAWA,GAAX,IAAiBC,OAAQ,WACrB,OAAO,cAAC,IAAD,CAAUC,IAAe,OAAXH,QAAW,IAAXA,OAAA,EAAAA,EAAaI,UAAW,gB,wBCPnDC,EAAY,YACZC,EAAS,SCMXC,GAAa,EAEbC,EAAe,CACfD,aACAE,QALU,IASC,aAAoD,IAA3CC,EAA0C,uDAAlCF,EAAcG,EAAoB,uCAC9D,OAAQA,EAAOC,MACX,KAAKP,EAML,KAAKC,EACD,OAAO,2BACAI,GADP,IAEIH,eAGR,QACI,OAAOG,ICrBJG,EALW,SAACC,GAAD,OAAaC,YAAgB,CACnDC,OAAQC,YAAcH,GACtBI,UCDSJ,EAAUK,c,sDC+CRC,EArCX,WAAYhD,GAAqB,IAAD,gCAXzBiD,kBAWyB,OATxBC,kBASwB,OARxBC,mBAQwB,OAPxBC,gBAOwB,OANxBC,gBAMwB,OAJxBC,YAIwB,OAHxBC,WAGwB,OAFxBC,UAEwB,OAQzBC,eARyB,uCAQR,WAAOC,GAAP,mBAAAC,EAAA,6DAChBC,EAAY,IAAIC,UACVC,OAAQ,aAAc,sBAChCF,EAAUE,OAAQ,OAAQJ,GAC1BE,EAAUE,OAAQ,YAAa,EAAKP,OACpCK,EAAUE,OAAQ,gBAAiB,EAAKN,MALpB,SAYVO,IAAMC,KAAK,gCAAiCJ,GACrDK,MAAK,SAAUC,GAA6C,IAAD,EAChB,EAAxC,QAA6BC,KAAzB,UAAAD,EAASE,YAAT,eAAeC,OACf,gBAAOH,EAASE,YAAhB,aAAO,EAAeE,kBAG1B,MAAO,CACHJ,EAASE,KAAKlB,aACdgB,EAASE,KAAKjB,cACde,EAASE,KAAKhB,WACdc,EAASE,KAAKf,eAtBF,mCAQhB,EAAKH,aARW,KAShB,EAAKC,cATW,KAUhB,EAAKC,WAVW,KAWhB,EAAKC,WAXW,iDARQ,sDAC5BkB,KAAKjB,OAAStD,EAAEa,GAAGG,YACnBuD,KAAKhB,MAAQvD,EAAEa,GAAGC,SAClByD,KAAKf,KAAOxD,EAAEa,GAAG2D,aAEjBD,KAAKtB,cAAe,GCKbwB,IFlBwBC,EEkBxBD,EAnBf,SAA2BzE,GACvB,MAAgCwB,qBAAhC,mBAAOmD,EAAP,KAAiBC,EAAjB,KACA,EAAepD,mBAAS,IAAjBqD,EAAP,oBAcA,OAZAC,qBAAU,WACN,IACMpB,EADc,IAAIqB,gBAAgB9D,OAAO+D,SAASC,QAC/BC,IAAI,QAAU,GACzB,IAAIlC,EAAYhD,GACxByD,eAAeC,GACpBO,OACAkB,UAEE,CAACP,EAAY5E,IAEpBoF,QAAQC,IAAIV,GAEJ,6BAAKE,KCLXS,GHViCZ,EGUV,GHTlBa,YACH9C,EAAkBC,GAClBgC,EACAc,YACIC,YACIC,YAAiBhD,OGM3Bd,EAAwB,CAC1BI,SAAU2D,mIAAYC,oBAAZ,UAAqCD,mIAAYC,qBAAwB,IAGjFtE,EAA+B,CACjCuE,SAAUF,mIAAYG,oBAAZ,UAAqCH,mIAAYG,qBAAwB,IACnFC,UAAWJ,mIAAYK,qBAAZ,UAAsCL,mIAAYK,sBAAyB,GACtFC,UAAWN,mIAAYO,qBAAZ,UAAsCP,mIAAYO,sBAAyB,GACtFC,IAAK,CACDnE,SAAU2D,mIAAYS,mBAAZ,UAAoCT,mIAAYS,oBAAuB,GACjFC,OAAQV,mIAAYW,yBAAZ,UAA0CX,mIAAYW,0BAA6B,IAE/FzF,GAAI,CACAC,SAAU6E,mIAAYY,iBAAZ,UAAkCZ,mIAAYY,kBAAqB,GAC7E/B,aAAcmB,mIAAYa,iBAAZ,UAAkCb,mIAAYa,kBAAqB,GACjFxF,YAAa2E,mIAAYc,kBAAZ,UAAmCd,mIAAYc,mBAAsB,KAI1FC,IAAS5E,OACL,cAAC,IAAD,CAAUwD,MAAOA,EAAjB,SACI,cAAC,IAAD,CAAiB5C,QAASA,EAA1B,SACI,mCACI,eAAC,IAAD,WACI,cAAC,IAAD,CAAOiE,OAAK,EAACC,MAAiB,OAAXhF,QAAW,IAAXA,OAAA,EAAAA,EAAaI,UAAW,mBAA3C,SACI,cAAC,IAAM6E,WAAP,UACI,cAAC,EAAD,eAAsBvF,QAG9B,cAAC,IAAD,CAAOqF,OAAK,EAACC,MAAiB,OAAXhF,QAAW,IAAXA,OAAA,EAAAA,EAAaI,UAAW,SAA3C,SACI,cAAC,IAAM6E,WAAP,UACI,cAAC,EAAD,eAAWvF,QAGnB,cAACwF,EAAD,CAAcH,OAAK,EAACC,KAAI,OAAEhF,QAAF,IAAEA,OAAF,EAAEA,EAAaI,SAAUJ,YAAaA,EAA9D,SACI,cAAC,IAAMiF,WAAP,UACI,cAAC,EAAD,eAASvF,QAGjB,cAAC,IAAD,CAAOyF,UAAWtF,aAKlCuF,SAASC,eAAe,W","file":"static/js/main.8e8e6d4c.chunk.js","sourcesContent":["import React from 'react';\nimport backendSettings from \"./module/settings/backend\";\n\nconst App = (_ :backendSettings) => {\n    return <h1>authorized</h1>\n}\n\nexport default App","import React from 'react';\nimport '../css/login.scss';\nimport backendSettings from \"../module/settings/backend\";\n\nconst url = require('url');\n\nfunction AuthForm (p :backendSettings) {\n\n    const signInYa = () => {\n        const requestUrl = url.parse(url.format({\n            protocol: 'https',\n            hostname: 'oauth.yandex.ru',\n            pathname: '/authorize',\n            query: {\n                response_type: 'code',\n                client_id: p.ya.clientID,\n                redirect_uri: p.ya.callbackURL\n            },\n        }));\n\n        window.open(requestUrl.href, \"_self\");\n    }\n\n    return (\n        <form className=\"login\">\n            <img src=\"/img/ya-auth.svg\" onClick={signInYa} alt=\"авторизация через яндекс аккаунт\"/>\n        </form>\n    )\n}\n\nexport default AuthForm","import React from 'react';\nimport backendSettings from \"./module/settings/backend\";\nimport AuthForm from \"./form/auth\";\n\nconst Login = (apiSettings :backendSettings) => {\n    const [authorized] = React.useState(false);\n\n    if (!authorized) {\n        return (\n                <AuthForm {...apiSettings}/>\n        )\n    }\n\n    return <h1>authorized</h1>\n}\n\nexport default Login","import React from 'react';\nimport './css/error.scss';\n\nfunction Error () {\n    return (\n        <div>\n            <h1>404 Not Found</h1>\n            <a href={\"/\"}>go back to main page</a>\n        </div>\n    )\n}\n\nexport default Error","import * as React from \"react\"\nimport settings from \"./settings/app\"\nimport { Route, Redirect } from 'react-router'\n\nfunction PrivateRoute({ children, appSettings, ...rest } :{children: JSX.Element; appSettings: settings; [rest: string]: any;}): JSX.Element {\n    return (\n        <Route {...rest} render={() => {\n            return <Redirect to={appSettings?.basePath + '/login'} />\n        }} />\n    )\n}\n\nexport default PrivateRoute","const AUTHORIZE = 'AUTHORIZE'\nconst LOGOUT = 'LOGOUT'\n\nexport {AUTHORIZE, LOGOUT}","import { AUTHORIZE, LOGOUT} from \"../actionTypes\";\n//import authPayload from \"../../module/auth/authPayload\";\ntype actionType = {\n    type :string\n}\n\nlet payload = {}\nlet authorized = false\n\nlet initialState = {\n    authorized,\n    payload\n};\n\n// eslint-disable-next-line import/no-anonymous-default-export\nexport default function(state = initialState, action: actionType) {\n    switch (action.type) {\n        case AUTHORIZE: {\n            return {\n                ...state,\n                authorized\n            };\n        }\n        case LOGOUT: {\n            return {\n                ...state,\n                authorized,\n            };\n        }\n        default:\n            return state;\n    }\n}\n","import { combineReducers } from \"redux\";\nimport { connectRouter } from 'connected-react-router'\nimport auth from \"./auth\";\n\nconst createRootReducer = (history) => combineReducers({\n    router: connectRouter(history),\n    auth\n})\n\nexport default createRootReducer","import {createBrowserHistory} from 'history'\nimport {applyMiddleware, compose, createStore} from 'redux'\nimport {routerMiddleware} from 'connected-react-router'\nimport createRootReducer from './reducers'\n\nexport const history = createBrowserHistory()\n\nexport default function configureStore(preloadedState :Object) {\n    return createStore(\n        createRootReducer(history), // root reducer with router state\n        preloadedState,\n        compose(\n            applyMiddleware(\n                routerMiddleware(history), // for dispatching history actions\n                // ... other middlewares ...\n            ),\n        ),\n    )\n}","import backendSettings from \"../settings/backend\";\nimport axios from 'axios';\n\nclass tokenBearer {\n    public isAuthorised: boolean\n\n    private access_token !: string\n    private refresh_token !: string\n    private token_type !: string\n    private expires_in !: number\n\n    private y_curi: string\n    private y_cid: string\n    private y_cs: string\n\n    constructor(p :backendSettings) {\n        this.y_curi = p.ya.callbackURL\n        this.y_cid = p.ya.clientID\n        this.y_cs = p.ya.clientSecret\n\n        this.isAuthorised = false\n    }\n\n    public getTokenByCode = async (code :string) => {\n        let form_data = new FormData();\n        form_data.append( 'grant_type', 'authorization_code' );\n        form_data.append( 'code', code );\n        form_data.append( 'client_id', this.y_cid );\n        form_data.append( 'client_secret', this.y_cs );\n\n        [\n            this.access_token,\n            this.refresh_token,\n            this.token_type,\n            this.expires_in\n        ] = await axios.post('https://oauth.yandex.ru/token', form_data)\n        .then(function (response) :[string, string, string, number] {\n            if (response.data?.error !== undefined) {\n                throw (response.data?.error_description)\n            }\n\n            return [\n                response.data.access_token,\n                response.data.refresh_token,\n                response.data.token_type,\n                response.data.expires_in,\n            ]\n        })\n    }\n\n}\n\nexport default tokenBearer","import backendSettings from \"../../settings/backend\";\n\nimport tokenBearer from \"../tokenBearer\";\n\nimport {useEffect, useState} from \"react\";\n\nfunction AuthVerification (p :backendSettings) {\n    const [appState, setAppState] = useState<tokenBearer>();\n    const [info] = useState('');\n\n    useEffect(() => {\n        const queryParams = new URLSearchParams(window.location.search)\n        const code = queryParams.get(\"code\") + ''\n        const token = new tokenBearer(p)\n        token.getTokenByCode(code)\n        .then()\n        .catch()\n\n        }, [setAppState,p]);\n\n    console.log(appState)\n\n    return (<h1>{info}</h1>);\n}\n\nexport default AuthVerification","import React from 'react'\nimport ReactDOM from 'react-dom'\nimport App from './App'\nimport Login from './Login'\nimport Error from './Error'\nimport './css/index.scss'\nimport backendSettings from \"./module/settings/backend\"\nimport settings from \"./module/settings/app\"\n\nimport { Provider } from 'react-redux'\nimport { Route, Switch } from 'react-router'\nimport { ConnectedRouter } from 'connected-react-router'\nimport RoutePrivate from './module/RoutePrivate'\nimport configureStore, { history } from './redux/storeConfig'\n\nimport AuthVerification from \"./module/auth/ya/verification\";\n\nconst store = configureStore({})\n\nconst appSettings :settings = {\n    basePath: process.env.REACT_APP_BASE_PATH ? `${process.env.REACT_APP_BASE_PATH}` : '',\n}\n\nconst apiSettings :backendSettings = {\n    tokenKey: process.env.REACT_APP_TOKEN_KEY ? `${process.env.REACT_APP_TOKEN_KEY}` : '1',\n    cookieKey: process.env.REACT_APP_COOKIE_KEY ? `${process.env.REACT_APP_COOKIE_KEY}` : '',\n    publicKey: process.env.REACT_APP_PUBLIC_KEY ? `${process.env.REACT_APP_PUBLIC_KEY}` : '',\n    api: {\n        basePath: process.env.REACT_APP_API_PATH ? `${process.env.REACT_APP_API_PATH}` : '',\n        domain: process.env.REACT_APP_CURRENT_DOMAIN ? `${process.env.REACT_APP_CURRENT_DOMAIN}` : ''\n    },\n    ya: {\n        clientID: process.env.REACT_APP_YA_CID ? `${process.env.REACT_APP_YA_CID}` : '',\n        clientSecret: process.env.REACT_APP_YA_CIS ? `${process.env.REACT_APP_YA_CIS}` : '',\n        callbackURL: process.env.REACT_APP_YA_CURI ? `${process.env.REACT_APP_YA_CURI}` : '',\n    }\n}\n\nReactDOM.render(\n    <Provider store={store}>\n        <ConnectedRouter history={history}>\n            <>\n                <Switch>\n                    <Route exact path={appSettings?.basePath + \"/verification/ya\"}>\n                        <React.StrictMode>\n                            <AuthVerification {...apiSettings} />\n                        </React.StrictMode>\n                    </Route>\n                    <Route exact path={appSettings?.basePath + \"/login\"}>\n                        <React.StrictMode>\n                            <Login {...apiSettings} />\n                        </React.StrictMode>\n                    </Route>\n                    <RoutePrivate exact path={appSettings?.basePath} appSettings={appSettings}>\n                        <React.StrictMode>\n                            <App {...apiSettings} />\n                        </React.StrictMode>\n                    </RoutePrivate>\n                    <Route component={Error} />\n                </Switch>\n            </>\n        </ConnectedRouter>\n    </Provider>,\n    document.getElementById('root')\n);"],"sourceRoot":""}